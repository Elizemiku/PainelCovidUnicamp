---
title: "Painel Covid - AM091"
date: "`r format(Sys.time(), '%d/%m/%Y')`"
runtime: shiny
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    source_code: embed
    social: menu
    theme: cosmo 
    navbar:  
      - {title: "Covid-R.M.Campinas", icon: glyphicon-signal, href: https://covid-rmc.netlify.app}
      - {title: "Github", icon: fa-github, href: https://github.com/Elizemiku/PainelCovidUnicamp}
---

```{r}
options(knitr.duplicate.label = 'allow', dplyr.summarise.inform = FALSE)
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

<!-- podemos criar um chunk pegando os codigos do twitter de um R script depois -->

```{r setup, include=FALSE}
library("tidyverse")
library("plotly")
library("flexdashboard")
library("shiny")
library("shinyWidgets")
```

```{r}
#Dados da Covid-19 no Estado de SP
link <- "https://raw.githubusercontent.com/seade-R/dados-covid-sp/master/data/dados_covid_sp.csv"
covid <- read_csv2(link)
```

Covid {data-navmenu="Análise de dados" data-icon="glyphicon-asterisk"}
=====================================  

Inputs {.sidebar}
-----------------------------------------------------------------------

```{r}
# tirei a opcao de escolher os dados porque podemos usar as abas das paginas para separar , ai depois vcs votam na melhor opcao haha

# seleção das Cidades
selectInput(
  inputId = "nome_munic", 
  label = "Cidades", 
  choices = c(covid$nome_munic),
  selected = "Campinas",
  multiple = TRUE)

 selectInput("Graficos", label = h4("Gráficos"), 
    choices = c("Barras","Linhas","Mapas"), 
    selected = "Linhas",
    multiple = FALSE)

selectInput("ObitosCasos", label = h4("Obitos e casos"), 
    choices = c("Obitos","Casos"), 
    selected = "Obitos",
    multiple = FALSE)
```

Outputs
-----------------------------------------------------------------------

### Grafico de Casos de Covid

```{r}
# filtro reativo das cidades 
filtro_cidades <- reactive({
  covid %>%  filter(nome_munic %in% input$nome_munic)
})

renderPlotly({

  if(input$Graficos == "Linhas"){
    ggplotly(
      ggplot(filtro_cidades(), 
             aes(x = semana_epidem, y = casos, color= nome_munic)) +
      geom_line() +
      labs(title = "Covid-19 por Cidade", 
           subtitle = "Por semanas epideomiológicas") +
      theme_bw())
  }
  
  # so um exemplo pra ver se funciona
  else{
    if(input$Graficos == "Barras"){
    ggplotly(
      ggplot(filtro_cidades(), 
             aes(x = semana_epidem, y = casos, fill= nome_munic)) +
      geom_bar(stat="identity", position = "dodge") +
      theme_bw()) 
    }
    else{
      if(input$Graficos == "Mapas"){
      }
    }
  }
  
})

```

Evolução (Gráfico animado) {data-navmenu="Extra" data-icon="glyphicon-search"}
=====================================  

Nuvem de palavras das autoridades {data-navmenu="Extra" data-icon="fa-hashtag"}
=====================================  

Inputs {.sidebar}
-----------------------------------------------------------------------

```{r}
selectInput("twitter", label = h4("Escolha a pessoa do twitter"), 
    choices = c("Bolsonaro","Dilma"), 
    selected = "Bolsonaro",
    multiple = FALSE)
```

Sobre {data-icon="fa-info-circle"}
=====================================  


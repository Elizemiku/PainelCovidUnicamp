---
title: "Painel Covid Unicamp - AM091"
date: 
runtime: shiny
output:
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
    source_code: embed
    highlight: pygments
    social: menu
    navbar:
    - title: Github
      icon: fa-github
      href: https://github.com/Elizemiku/PainelCovidUnicamp
    includes:
      after_body: footer.html
resource_files:
- tweet.R
---

<!-- cores e estilos em html pra dashboard -->
<!-- deixei branco mas se quiserem podemos mudar depois-->

<style>

.colored {
background-color: #ffccff;
} 

.first-box {
  background-color: #ffccff;
  color: black;
}

body {background-color:#d9d9d9;}

.navbar {
  background-color: #80002a;
}

.navbar-inverse .navbar-nav > li > a:hover,
.navbar-inverse .navbar-nav > li > a:focus {
    color: black;
    background-color: #ffc34d;
}

.navbar-inverse .navbar-nav > .active > a,
.navbar-inverse .navbar-nav > .active > a:hover,
.navbar-inverse .navbar-nav > .active > a:focus {
  color: black;
  background-color:#ffc34d;
}

.navbar-inverse .navbar-toggle:hover,
.navbar-inverse .navbar-toggle:focus {
  background-color: #ffc34d;
}

.navbar-inverse .navbar-collapse,
.navbar-inverse .navbar-form {
  border-color: #ffc34d;
}

</style>


<!-- codigo da dashboard -->

```{r setup, include=FALSE}
# bibliotecas utilizadas 
library("tidyverse")
library("plotly")
library("flexdashboard")
library("shiny")
library("shinyWidgets")
library("geobr")
library("gganimate")
library("rsconnect")
# opcoes das tabelas DT, caso usemos e do codigo
# options(knitr.duplicate.label = 'allow', 
#         dplyr.summarise.inform = FALSE,
#         DT.options = list(
#           initComplete = JS(
#             "function(settings, json) 
#             {","$(this.api().table().header()).css({'background-color': '#1d80e2  ',
#             'color': 'white'});","}"
#             ),
#           pageLength = 5,
#           language = list(search = 'Busca:'),
#           lengthMenu = c(5, 10, 15, 20)
# ))
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

<!-- podemos criar um chunk pegando os codigos do twitter do R script  -->


```{r, results='hide'}
#Dados da Covid-19 no Estado de SP
link <- "https://raw.githubusercontent.com/seade-R/dados-covid-sp/master/data/dados_covid_sp.csv"
covid <- read_csv2(link)
# deixando o nome das colunas bonitinhos
covid <- covid %>% 
  rename("Semana_epidemiológica" = semana_epidem, 
         "Cidade" = nome_munic, "mês" = mes, "óbitos" = obitos, 
         "óbitos_novos" = obitos_novos, "Dia" = datahora)
#Dados da Dengue
#Dados da SRAG
```

Covid-19 {data-navmenu="Análise de dados" data-icon="fa-allergies"}
=====================================  

Inputs {.sidebar}
-----------------------------------------------------------------------

\newline

**Seja Bem-Vindo!**

\newline
\newline

```{r}

# seleção das Cidades
pickerInput(
  inputId = "Cidade", 
  label = "Cidades do Estado de São Paulo:", 
  choices = c(unique(covid$Cidade)),
  selected = "Campinas",
  multiple = TRUE,
  options = list(title ='Selecione uma Cidade',`max-options` = 5)
  )

# seleção do tipo de gráfico
pickerInput(
   inputId = "Graficos", 
   label = "Tipo de gráfico:", 
   choices = c("Barras","Linhas"), 
   selected = "Linhas",
   multiple = FALSE,
   options = list(title='Selecione o tipo de Gráfico')
   )

# seleção do eixo x
pickerInput(
   inputId = "Opcao", 
   label = "Formatos de data:", 
   choices = c("Dia", "Semana_epidemiológica", "mês"), 
   selected = "Dia",
   multiple = FALSE,
   options = list(title='Selecione o tipo da Data')
  )
   
# seleção do eixo y 
pickerInput(
  inputId = "ObitosCasos", 
  label = "Tipo de ocorrência:", 
  choices = c("casos", "casos_novos", "óbitos", "óbitos_novos"), 
  selected = "casos",
  multiple = FALSE,
  options = list(title='Selecione o tipo de ocorrência')
  )
```

Outputs
-----------------------------------------------------------------------

### Gráficos da Covid-19

```{r}
# filtro reativo das cidades 
filtro_cidades <- reactive({
    covid %>%  filter(Cidade %in% input$Cidade) 
})

# graficos 

output$plotly <- renderPlotly({
  
  # para evitar de aparecer mensagem de erro ao não selecionar
  # nenhuma cidade
  if(is.null(input$Cidade)){
    return()
  }
  
  # gera o rafico
  else{
      if(input$Graficos == "Linhas"){
      # grafico de linhas interativo
      # numero de opcoes do eixo y por opcoes do eixo x
      ggplotly(
        ggplot(filtro_cidades(), 
               aes_string(x = input$Opcao, y = input$ObitosCasos)) +
        geom_line(aes(color =  Cidade)) +
        labs(title = "Covid-19 por Cidade",
             x = paste("Por", input$Opcao, sep = " "),
             y = paste("Número de", input$ObitosCasos, sep = " ")) +
         theme(axis.line = element_line(colour = "black"),
               panel.background = element_rect(fill = "white", size = 2),
               panel.grid.major = element_line(colour = "gray",
                                               size = 1,
                                               linetype = "solid"),
               panel.grid.minor = element_line(colour = "gray",
                                               size = 1,
                                               linetype = "solid"))) %>%
      layout(legend = list(orientation = 'h', x = 0.2, y = 1.1))
    }
  
    else if(input$Graficos == "Barras"){
      # grafico de barras interativo
      # numero de opcoes do eixo y por opcoes do eixo x
      ggplotly(
        ggplot(filtro_cidades(), 
               aes_string(x = input$Opcao, y = input$ObitosCasos)) +
        geom_bar(stat="identity", position = "dodge", aes(fill = Cidade)) +
        labs(title = "Covid-19 por Cidade", 
             x = paste("Por", input$Opcao, sep = " "),
             y = paste("Número de", input$ObitosCasos, sep = " ")) + 
        theme(axis.line = element_line(colour = "black"),
              panel.background = element_rect(fill = "white", size = 2),
              panel.grid.major = element_line(colour = "gray",
                                              size = 1,
                                              linetype = "solid"),
              panel.grid.minor = element_line(colour = "gray",
                                              size = 1,
                                              linetype = "solid"))) %>%
      layout(legend = list(orientation = 'h', x = 0.2, y = 1.1))
      }
  }
})

plotlyOutput('plotly')
```

Covid e outras doenças {data-navmenu="Análise de dados" data-icon="fa-search"}
=====================================  

Row
--------------------------------------------------------------

Queremos ilustrar o impacto da Covid-19 nas estatísticas de Síndrome Respiratória Aguda Grave (SRAG). Para isso, temos os dados da SRAG no estado de SP no ano de 2019 e os dados da SRAG no estado até o começo de Agosto deste ano. 

Sobre a SRAG temos este trecho do boletim epidemiológico feito pelo Núcleo de Vigilância Epidemiológica Hospitalar com a Santa Casa de Misericórdia de Goiânia:

"Dentre os principais agentes etiológicos que resultam em SRAG, estão os vírus (influenza A, dengue, vírus sincicial respiratório, adenovírus, hantavírus e coronavírus), e outros agentes (pneumococos,outrasbactérias, Legionella sp., leptospirose, etc.) ... Considera-se caso suspeito de SRAG todos os indivíduos de qualquer idade com doença respiratória aguda caracterizada por febre superior a 38ºC, tosse e dispneia, acompanhadas ou não de dor de garganta ou manifestações gastrointestinais. Além disso, devem ser observados os seguintes sinais e sintomas: aumento d afrequência respiratória (>25 rpm) e hipotensão em relação à pressão arterial habitual do paciente. Em crianças, acrescentam-se os seguintes sintomas: batimentos de asa de nariz, cianose, tiragem intercostal,desidratação e inapetência"

```{r}
#comparação
```

```{r}
#srag2020 e as causas 
```

No início da pandemia, não era raro ouvirmos certos comentários infundados comparando a Covid-19 com outras doenças conhecidas, como por exemplo a gripe - o termo "gripezinha" foi uma ilação do presidente, inclusive - No intuito de naturalizar a gravidade do problema que estamos enfrentando. 

Gráficos animados {data-icon="fa-chart-line"}
=====================================  
Row 
-------------------------------------
    
### Mapa do estado de SP
<img src="https://raw.githubusercontent.com/Elizemiku/PainelCovidUnicamp/master/dados/evolucao.gif" alt="mapa"/>    

Row {.tabset .tabset-fade}
-------------------------------------
   
### Incidência

<img src="https://raw.githubusercontent.com/Elizemiku/PainelCovidUnicamp/master/dados/casos.gif" alt="incidencia"/>

### Óbitos
    
<img src="https://raw.githubusercontent.com/Elizemiku/PainelCovidUnicamp/master/dados/mortes.gif" alt="obitos"/>

Nuvem de palavras dinâmica {data-icon="fa-hashtag"}
=====================================  

Inputs {.sidebar}
-----------------------------------------------------------------------

```{r , code = readLines("tweet.R"), echo = FALSE, eval = FALSE}
# colocar em choices o dicionario que esta em tweet.R
# renderUI(
#   selectizeInput(
#   inputId = "conta", 
#   label = "Escolha a pessoa do twitter", 
#   choices = contas, 
#   selected = "jairbolsonaro",
#   multiple = TRUE,
#   options = list(create=TRUE, maxItems=4, minItems = 1,
#                  placeholder='Selecione uma conta',
#                  allowEmptyOption = FALSE, selectOnTab = TRUE))
# )
# get_timeline(input$conta, n=1000)
# chamar nuvem
```

Outputs
-----------------------------------------------------------------------

```{r}
# chamar o codigo do twitter aqui 
# grafico 
# nuvem_de_palavras
```


Sobre {data-icon="fa-info-circle"}
=====================================  

Row
--------------------------------------------------------------

### Informações sobre este projeto { .first-box }

Painel Covid Unicamp - AM091 é um site feito para o projeto da disciplina de AM091 da Universidade Estadual de Campinas. O objetivo desse projeto constituiu-se em aproximar os alunos Elizabeth, Isabella e Vinicius do curso de Estatística na aplicação da parte prática do conhecimento estatístico, com enfoque nos dados da Covid-19 do Brasil. Além de contribuir para a aprendizagem dos alunos também é uma contribuição para o país demonstrando que todos estão se dedicando nesse tempo de Pandemia.


Covid-19 {data-navmenu="Dados utilizados"  data-icon="fa-table"}
===================================== 

```{r}
# tabela dados de covid de campinas 
# datatable(
#   covid %>% filter(Cidade == "Campinas"),
#   colnames = c('ID' = 1),
#   caption =  htmltools::tags$caption(
#     style = 'caption-side: top; text-align: left; color:blue; font-size: 16px',
#     'Tabela 1: ',
#     htmltools::em('Dados da Covid-19 utilizados para as análises',)
#   ),
#   class = c('cell-border stripe'),
#   extensions = c('Buttons'),
#   options = list(dom = 'Bfrtip',
#                  buttons = c('csv', 'excel', 'print'))
# )
```

Dengue {data-navmenu="Dados utilizados" data-icon="fa-table"}
===================================== 
```{r}
```

SRAG {data-navmenu="Dados utilizados" data-icon="fa-table"}
===================================== 
```{r}
```

